{"job":{"components":{"1953":{"id":1953,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-319648201,"x":496,"y":-16,"width":32,"height":32,"inputConnectorIDs":[1961],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"create_view_prod_scd"}}}},"visible":true},"2":{"slot":2,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"3":{"slot":3,"name":"View Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"VW_PROD_SCD_MAT"}}}},"visible":true},"5":{"slot":5,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Secure View","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"7":{"slot":7,"name":"View Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Standard"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1954":{"id":1954,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":368,"y":-16,"width":32,"height":32,"inputConnectorIDs":[1963],"outputConnectorIDs":[1961],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"calc_prod_stream"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"IFF(\n\"STR_ACTION\"='INSERT' AND \"STR_UPDATE\" = TRUE AND\n  \"DIM_PROD_COST\" != \"PRODCOST\", 'U', \n  \nIFF(\"STR_ACTION\"='INSERT' AND \"STR_UPDATE\" = FALSE ,'I', \n\n    IFF(\"STR_ACTION\"='DELETE' AND \"STR_UPDATE\" = FALSE ,'D',\n        \n        IFF(\"STR_ACTION\"='INSERT' AND \"STR_UPDATE\" = TRUE AND\n  \"DIM_PROD_COST\" = \"PRODCOST\", 'N',''))))\n    \n\n"},"2":{"slot":2,"type":"STRING","value":"ACTION"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"'9999-12-31 00:00:00.000'::timestamp_ltz"},"2":{"slot":2,"type":"STRING","value":"EXPIRYTIME"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"current_timestamp()"},"2":{"slot":2,"type":"STRING","value":"CURTIME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"FALSE"},"2":{"slot":2,"type":"STRING","value":"CURFLAG"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1955":{"id":1955,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":-112,"y":-16,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[1959],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STG_PRODGROUPS"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STG_PRODGROUPS"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GROUP_ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"GROUPNAME"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"DIVISION"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1956":{"id":1956,"inputCardinality":"MANY","outputCardinality":"MANY","implementationID":-629958239,"x":176,"y":-16,"width":32,"height":32,"inputConnectorIDs":[1959,1960,1962],"outputConnectorIDs":[1963],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"join_prods_groups"}}}},"visible":true},"2":{"slot":2,"name":"Main Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stream_products"}}}},"visible":true},"3":{"slot":3,"name":"Main Table Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"main"}}}},"visible":true},"4":{"slot":4,"name":"Joins","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STG_PRODGROUPS"},"2":{"slot":2,"type":"STRING","value":"grp"},"3":{"slot":3,"type":"STRING","value":"Inner"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"DM_PRODUCTS_SCD"},"2":{"slot":2,"type":"STRING","value":"dim"},"3":{"slot":3,"type":"STRING","value":"Left"}}}},"visible":true},"5":{"slot":5,"name":"Join Expressions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"main\".\"GROUP_ID\"=\"grp\".\"GROUP_ID\""},"2":{"slot":2,"type":"STRING","value":"main_Inner_grp"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"\"main\".\"PRODUCT_ID\"=\"dim\".\"PRODUCT_ID\""},"2":{"slot":2,"type":"STRING","value":"main_Left_dim"}}}},"visible":true},"6":{"slot":6,"name":"Output Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"main.PRODUCT_ID"},"2":{"slot":2,"type":"STRING","value":"PRODUCT_ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"main.GROUP_ID"},"2":{"slot":2,"type":"STRING","value":"GROUP_ID"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"main.PRODUCT"},"2":{"slot":2,"type":"STRING","value":"PRODUCT_DESC"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"main.PRODCOST"},"2":{"slot":2,"type":"STRING","value":"PRODCOST"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"main.UPDATE_TS"},"2":{"slot":2,"type":"STRING","value":"UPDATE_TS"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"grp.GROUPNAME"},"2":{"slot":2,"type":"STRING","value":"GROUP_DESC"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"grp.DIVISION"},"2":{"slot":2,"type":"STRING","value":"DIVISION"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"dim.PRODUCT_COST"},"2":{"slot":2,"type":"STRING","value":"DIM_PROD_COST"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"main.METADATA$ACTION"},"2":{"slot":2,"type":"STRING","value":"STR_ACTION"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"main.METADATA$ISUPDATE"},"2":{"slot":2,"type":"STRING","value":"STR_UPDATE"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1957":{"id":1957,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":-684341771,"x":-16,"y":144,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[1962],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stream_products"}}}},"visible":true},"2":{"slot":2,"name":"Target Stream","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"STR_PRODUCTS"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PRODUCT_ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"GROUP_ID"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"PRODUCT"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"PRODCOST"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"UPDATE_TS"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"METADATA$ACTION"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"METADATA$ISUPDATE"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1958":{"id":1958,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":-96,"y":64,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[1960],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DM_PRODUCTS_SCD"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DM_PRODUCTS_SCD"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PRODUCT_ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"PRODUCT_COST"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DW"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"1959":{"id":1959,"sourceID":1955,"targetID":1956},"1960":{"id":1960,"sourceID":1958,"targetID":1956},"1961":{"id":1961,"sourceID":1954,"targetID":1953},"1962":{"id":1962,"sourceID":1957,"targetID":1956},"1963":{"id":1963,"sourceID":1956,"targetID":1954}},"notes":{},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"test_SubJob_Products_SCD_02","description":"","type":"TRANSFORMATION","tag":"b47b714c-1e9a-41de-8fdf-3906b5882808"}}