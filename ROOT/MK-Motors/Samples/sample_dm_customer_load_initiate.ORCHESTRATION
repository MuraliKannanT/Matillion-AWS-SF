{"job":{"components":{"1861":{"id":1861,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-752,"y":-128,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[1866],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Start","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1862":{"id":1862,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"ITERATE","implementationID":1025742816,"x":-400,"y":-128,"width":32,"height":16,"inputConnectorIDs":[1865],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Loop Iterator 0"}}}},"visible":true},"2":{"slot":2,"name":"Variable to Iterate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"env_cust_rec_count"}}}},"visible":true},"3":{"slot":3,"name":"Starting Value","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"1"}}}},"visible":true},"4":{"slot":4,"name":"Increment Value","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"1"}}}},"visible":true},"5":{"slot":5,"name":"End Value","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${env_cust_iter}"}}}},"visible":true},"6":{"slot":6,"name":"Break on Failure","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"7":{"slot":7,"name":"Concurrency","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sequential"}}}},"visible":true},"8":{"slot":8,"name":"Stop on Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"9":{"slot":9,"name":"Stop Condition Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":false},"10":{"slot":10,"name":"Condition","elements":{},"visible":false},"11":{"slot":11,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":false},"12":{"slot":12,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"999":{"slot":999,"name":"Record Values In Task History","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[1867],"inputIterationConnectorIDs":[]},"1863":{"id":1863,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186829,"x":-608,"y":-128,"width":32,"height":32,"inputConnectorIDs":[1866],"outputSuccessConnectorIDs":[1865],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python Script 0"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print (myvar)\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print (context.getGridVariable('mygridvar'))\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\ncursor = context.cursor()\n# cursor.execute('select count(*) from mkmotors.stg.stg_customers')\n# totcnt = cursor.fetchone()[0]\ntotcnt = 200\ncursor.execute('select count(*) from mkmotors.dw.dm_customers')\ncontext.updateVariable('env_totcustdm',cursor.fetchone()[0]+1)\nitercount = int(totcnt/50)\nremaind = totcnt%50\nif remaind != 0:\n\titercount = itercount + 1\ncontext.updateVariable('env_cust_iter',itercount)\ncontext.updateVariable('env_totcuststg',totcnt+env_totcustdm)\nprint \"Iterations: \" + str(itercount)\nprint \"Total Recs: \" + str(totcnt) \nprint \"Start  Key: \" + str(env_totcustdm)\n\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Jython"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":false},"5":{"slot":5,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1864":{"id":1864,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-400,"y":-128,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"cust_load_grid"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"sample_dm_customer_load_grid"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[1867]}},"successConnectors":{"1865":{"id":1865,"sourceID":1863,"targetID":1862}},"failureConnectors":{},"unconditionalConnectors":{"1866":{"id":1866,"sourceID":1861,"targetID":1863}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{"1867":{"id":1867,"sourceID":1862,"targetID":1864}},"noteConnectors":{},"notes":{},"variables":{},"grids":{"grid_input_cust":{"definition":{"name":"grid_input_cust","scope":"TASKBATCH","definitions":[{"name":"DEALERSHIP_ID","type":"DECIMAL"},{"name":"CUSTOMER_REGION","type":"TEXT"},{"name":"CUSTOMER_ID","type":"DECIMAL"},{"name":"CUSTOMER_FIRSTNAME","type":"TEXT"},{"name":"CUSTOMER_LASTNAME","type":"TEXT"},{"name":"CUSTOMER_ADDRESS","type":"TEXT"},{"name":"CUSTOMER_CITY","type":"TEXT"},{"name":"CUSTOMER_STATE","type":"TEXT"},{"name":"CUSTOMER_ZIPCODE","type":"DECIMAL"},{"name":"CUSTOMER_COUNTRY","type":"TEXT"},{"name":"CUSTOMER_PHONE","type":"TEXT"},{"name":"CUSTOMER_GENDER","type":"TEXT"},{"name":"CUSTOMER_INCOME","type":"DECIMAL"},{"name":"CUSTOMER_EMAIL","type":"TEXT"},{"name":"CUSTOMER_AGE","type":"DECIMAL"},{"name":"LAST_UPDATED","type":"DATETIME"}],"description":"","visibility":"PUBLIC"},"values":[]}}},"info":{"name":"sample_dm_customer_load_initiate","description":"","type":"ORCHESTRATION","tag":"44ad7a09-c41a-4475-a71b-085433e937f5"}}